#!/bin/bash

set -e
export DEBIAN_FRONTEND=noninteractive

# ===== COLORS =====
GREEN="\e[32m"
CYAN="\e[36m"
YELLOW="\e[33m"
RED="\e[31m"
RESET="\e[0m"

clear
echo -e "${CYAN}"
echo "======================================"
echo "        GeyserMC Installer"
echo "======================================"
echo -e "${RESET}"

# ===== UPDATE SYSTEM =====
echo -e "${CYAN}> Updating system...${RESET}"
sudo apt update -qq

cd server || {
    echo -e "${RED}> Server directory not found!${RESET}"
    exit 1
}

# ===== GEYSER TYPE =====
echo ""
echo -e "${YELLOW}[1] Geyser Standalone"
echo "[2] Geyser Plugin (Paper / Spigot only)${RESET}"
echo ""

read -rp "Select Geyser Type [1-2]: " GEYSER_TYPE

# ===== INSTALL =====
if [[ "$GEYSER_TYPE" == "2" ]]; then
    echo -e "${GREEN}> Installing Geyser Plugin...${RESET}"
    mkdir -p plugins
    wget -q \
        https://download.geysermc.org/v2/projects/geyser/versions/latest/builds/latest/downloads/spigot \
        -O plugins/geyser.jar
else
    echo -e "${GREEN}> Installing Geyser Standalone...${RESET}"
    mkdir -p geyser
    wget -q \
        https://download.geysermc.org/v2/projects/geyser/versions/latest/builds/latest/downloads/standalone \
        -O geyser/geyser.jar
fi

# ===== DONE =====
echo ""
echo -e "${GREEN}âœ” Geyser installed successfully!${RESET}"
echo -e "${CYAN}Restart your server to apply changes${RESET}"
echo ""
